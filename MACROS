Sub lock_cell()
'
' MACRO para confirmar e salvar os dados de sell out e estoque
' ---- Desenvolvido por Victor Gonçalves
' ---- 16/12/2022



    Application.ScreenUpdating = False
    Application.EnableEvents = False

'MENSAGEM DE CONFIRMAÇÃO

    Result = MsgBox("Deseja GRAVAR os DADOS ?", vbOKCancel + vbExclamation, "INPUT DADOS")
    If Result = 1 Then
        MsgBox "Dados Salvos", vbExclamation, "INPUT DADOS"
    Else: MsgBox "Dados não salvos", vbExclamation, "INPUT DADOS"
        Exit Sub
    End If
        
    
'SELECIONAR AS COLUNAS
    Columns("F:G").Select

    
'DESTRAVAR A PLANILHA

    If ActiveSheet.ProtectContents = True Then
        ActiveSheet.Unprotect Password:="1"
    End If
    
'PINTAR DE CINZA
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    
'TRAVAR A PLANILHA

    Selection.Locked = True
    'ActiveSheet.Protect Contents:=True
    ActiveSheet.Protect Password:="1", UserInterfaceOnly:=True
    'Contents:=True

    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub
---------------------------------------
' MACRO PARA COLAR OS DADOS COMO VALOR E REALIZAR A VALIDAÇÃO DOS DADOS CONFORME CLIENTE E REFERENCIA.
' Desenvolvido por Victor Gonçalves
' Data 01/08/2022

Private Sub Worksheet_Change(ByVal Target As Range)
'guia do Excel


    Dim cell As Range
    
    On Error GoTo Trata_Erro
    
    'COLAR COMO VALOR

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    If Application.CutCopyMode = xlCopy Then
        Application.Undo
        
        Target.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _
                            SkipBlanks:=False, Transpose:=False
    End If
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    Application.CutCopyMode = False
    
    
    'validacao referencia
    If Not Intersect(Target, Me.Range("A2:B5000")) Is Nothing Then
        For Each cell In Target
            If Not cell.Validation.Value Then
                
                MsgBox "Dado Inválido: " & cell.Value, vbCritical
                Selection.ClearContents
                'Selection.ClearFormatting
                'Application.Undo
                Exit Sub
                    
            End If
        Next
    End If


    
Trata_Erro:
    Exit Sub
End Sub

---------------------------------------
'Macro para evitar que o usuario utilize o CORTAR e COLAR.
'Evitando erros de formatação


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    'Evitar CUT
    Select Case Application.CutCopyMode
    Case Is = xlCut
    MsgBox "Por favor, Não Cortar e Colar."
    Application.CutCopyMode = False 'clear clipboard and cancel cut
    End Select
End Sub
